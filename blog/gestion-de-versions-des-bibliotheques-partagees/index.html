<!DOCTYPE html>
<html lang="fr-CA" class="no-js"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script><link media="all" href="https://dev-pro.xyz/blog/wp-content/cache/autoptimize/css/autoptimize_3856cada20bef986579d474c88d62b88.css" rel="stylesheet"><title>Gestion de versions des bibliothèques partagées – Dev-Pro Informatique</title><script type="text/javascript" src="https://dev-pro.xyz/blog/wp-includes/js/jquery/jquery.js"></script><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
                     google_ad_client: "ca-pub-1370898179955590",
                     enable_page_level_ads: true
                });</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-154856998-1"></script><script>window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-154856998-1');</script></head><body class="post-template-default single single-post postid-235 single-format-standard wp-custom-logo"><div class="body-wrap fullwidth-container"><nav class="navbar navbar-light bg-white border-bottom navbar-expand-lg justify-content-between px-5 py-4 fullwidth-container"><div class="navbar-brand py-0 mb-0"> <a href="https://dev-pro.xyz/blog/" class="custom-logo-link" rel="home"><noscript><img width="132" height="29" src="https://dev-pro.xyz/blog/wp-content/uploads/2019/12/logo.png" class="custom-logo" alt="Dev-Pro Informatique"></noscript><img width="132" height="29" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20132%2029%22%3E%3C/svg%3E" data-src="https://dev-pro.xyz/blog/wp-content/uploads/2019/12/logo.png" class="lazyload custom-logo" alt="Dev-Pro Informatique"></a> <a href="https://dev-pro.xyz/blog/" title="Dev-Pro Informatique" rel="home" class="site-title text-dark">Dev-Pro Informatique</a></div> <span class="navbar-text site-description text-info small d-none d-md-block">Solution Technologique</span> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle Navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbar-content"><ul id="primary-menu" class="navbar-nav ml-auto"><li id="menu-item-62" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-62 nav-item"><a href="https://dev-pro.xyz/blog/acceuil/" class="nav-link">Accueil</a></li></ul></div></nav><div class="container my-lg-5 my-sm-3"><div class="row"><div class="col-md-12 col-lg-8"><div class="content my-5"><article id="post-235" class="mb-5 post-235 post type-post status-publish format-standard hentry category-libc category-linker category-linux category-symboles category-whitepaper"><p class="text-uppercase mb-1"><a href="https://dev-pro.xyz/blog/category/libc/" rel="category tag">libc</a>, <a href="https://dev-pro.xyz/blog/category/linker/" rel="category tag">linker</a>, <a href="https://dev-pro.xyz/blog/category/linux/" rel="category tag">Linux</a>, <a href="https://dev-pro.xyz/blog/category/symboles/" rel="category tag">symboles</a>, <a href="https://dev-pro.xyz/blog/category/whitepaper/" rel="category tag">WhitePaper</a></p><h2 class="entry-title"><a href="https://dev-pro.xyz/blog/gestion-de-versions-des-bibliotheques-partagees/" rel="bookmark">Gestion de versions des bibliothèques partagées</a></h2><p class="meta text-muted text-info small"> By <a href="https://dev-pro.xyz/blog/author/siz/">siz</a> on décembre 27, 2019 <span>•</span> 0 Comments</p><div class="clearfix"></div><div class="entry"><div><p>Tout code est susceptible au changement, avec pour objectif d’ajouter des fonctionnalités, de résoudre des BUGS ou même d’aller jusqu’a modifier les interfaces (<em>altérer les prototypes des fonctions</em>).</p><p>Généralement plus un code est utilisé par la communauté, plus il est déconseillé de modifier les interfaces lors d’une évolution. Cependant, la rétrocompatibilité reste floue pour certains développeurs surtout lors de la mise à jour des <strong>bibliothèques partagées</strong>.</p><p>Dans cet article, nous découvrirons comment maintenir les bibliothèques pour pouvoir les distribuer et les modifier sans avoir à recompiler les anciens binaires.  Ces derniers pourront ainsi bénéficier d’une amélioration de performances ou de corrections de failles de sécurité.</p><h2>Pourquoi la gestion de version des bibliothèques?</h2><p>Pour répondre à cette question il est important de connaître quelques concepts liés aux bibliothèques partagées.</p><h3>Quelques conventions à retenir</h3><ul><li>Une bibliothèque partagée doit être compilée comme ceci :</li></ul><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #996633">$ </span>gcc -Wall -fPIC -c bibliotheque_dynamique.c
<span style="color: #996633">$ </span>gcc -shared bibliotheque_dynamique.o -o bibliotheque_dynamique.so
</pre></div><p>L’argument  « -shared » est un flag linker utilisé pour créer les bibliothèques partagées.</p><p><strong>Remarque :</strong> le flag du compilateur « -fPIC » ne doit pas être associé à la création des bibliothèques partagées (<em>il est possible de l’utiliser pour créer des bibliothèques statiques</em>).</p><ul><li>Par convention, le nom d’une bibliothèque partagée prend la forme : <strong>lib</strong>nombibliotheque<strong>.so.<M>.<m>.<p></strong> (par exemple : <em>libssl</em>.<em>so</em>.1.0.0).</li></ul><p><strong>N.B :</strong> les symboles <strong>M</strong>, <strong>m</strong> et <strong>p</strong> désignent les nombres <strong>M</strong>ajeur, <strong>m</strong>ineur et <strong>p</strong>atch respectivement. Ces derniers précisent l’impact du changement de version sur le code, par exemple : la modification de la signature d’une fonction est un changement de type majeur alors que l’optimisation d’un calcul dans une routine a des conséquences mineures.</p><h3>Alors pourquoi versionner?</h3><p>Pour démontrer l’importance du versionnage, nous allons créer une simple bibliothèque partagée (<em>et suivre son évolution</em>).</p><h4>Exemple pratique</h4><p>Pour les besoins d’un outil de monitoring du système, nous implémentons une bibliothèque qui permet de lister les différents utilisateurs connectés sur le système.</p><h4>Solution proposée</h4><p>Sous Linux, il existe deux fichiers qui se chargent de cette tâche :</p><ul><li><strong>/var/run/utmp :</strong> qui liste les utilisateurs connectés (<em>utilisé par l’utilitaire who</em>).</li><li><strong>/var/log/wtmp :</strong> sauvegarde chaque connexion et déconnexion établie par un utilisateur (<em>utilisé par l’utilitaire « last »</em>).</li></ul><h4>Première release : libusrmgr.so.1.0.0</h4><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/no_method_build_fail/libusrmgr.so.1.0.0/usrmgr.h">usrmgr.h</a> : fichier header de la bibliothèque « <strong>libusrmgr.so.1.0.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include <stdlib.h></span>
<span style="color: #557799">#include <utmpx.h></span>
<span style="color: #557799">#include <time.h></span>

<span style="color: #888888">/* Retourne la liste des utilisateurs connectés */</span>
<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getLoggedUsers</span>();
</pre></div><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/no_method_build_fail/libusrmgr.so.1.0.0/usrmgr.c">usrmgr.c :</a> implémentation de la bibliothèque « <strong>libusrmgr.so.1.0.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "usrmgr.h"</span>

<span style="color: #888888">/* Retourne la liste des utilisateurs connectés */</span>
<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getLoggedUsers</span>(){
    <span style="color: #008800;font-weight: bold">struct</span> utmpx <span style="color: #333333">*</span>utmpUser;

    setutxent(); <span style="color: #888888">// Ouverture du fichier /var/run/utmp</span>

    <span style="color: #888888">/* Parcours de la liste des utilisateurs */</span>
    <span style="color: #008800;font-weight: bold">while</span> ((utmpUser <span style="color: #333333">=</span> getutxent()) <span style="color: #333333">!=</span> <span style="color: #007020">NULL</span>) {
        printf(<span style="background-color: #fff0f0">"Utilisateur : %s <=> PID : %ld at : %s"</span>, utmpUser<span style="color: #333333">-></span>ut_user,
         (<span style="color: #333399;font-weight: bold">long</span>) utmpUser<span style="color: #333333">-></span>ut_pid, ctime((<span style="color: #333399;font-weight: bold">time_t</span> <span style="color: #333333">*</span>) <span style="color: #333333">&</span>(utmpUser<span style="color: #333333">-></span>ut_tv.tv_sec)));
    }
}
</pre></div><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/lib_build_ko/old_binary/oldBinary.c">premierBinaire.c :</a> binaire client (qui va utiliser notre bibliothèque partagée).</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "usrmgr.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(){
    printf(<span style="background-color: #fff0f0">"La liste des utilisateurs connectés : </span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>);
    getLoggedUsers();

    <span style="color: #008800;font-weight: bold">return</span> EXIT_SUCCESS;
}
</pre></div><p>Il ne reste plus qu’à réaliser la compilation et le test :</p><ul><li>Compiler une bibliothèque partagée :</li></ul><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #996633">$ </span>gcc -Wall -fPIC -c usrmgr.c
<span style="color: #996633">$ </span>gcc -shared usrmgr.o -o libusrmgr.so.1.0.0
</pre></div><ul><li>Compiler le binaire et tester l’exécution :</li></ul><ul class="wp-block-gallery aligncenter columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/09/users_listed.png" alt="" data-id="6876" data-link="http://www.linuxembedded.fr/?attachment_id=6876" class="wp-image-6876 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/09/users_listed.png 746w,https://www.linuxembedded.fr/wp-content/uploads/2019/09/users_listed-300x74.png 300w" sizes="(max-width: 746px) 100vw, 746px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/09/users_listed.png" alt="" data-id="6876" data-link="http://www.linuxembedded.fr/?attachment_id=6876" class="lazyload wp-image-6876 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/09/users_listed.png 746w, https://www.linuxembedded.fr/wp-content/uploads/2019/09/users_listed-300x74.png 300w" data-sizes="(max-width: 746px) 100vw, 746px"></figure></li></ul><h4>Deuxième release : libusrmgr.so.2.0.0</h4><p>Au fil du temps, on se rend compte des besoins suivants :</p><ul><li>Le fichier utmp (<em>ouvert avec setutxent()</em>) n’est pas fermé après avoir obtenu la liste des utilisateurs (<em>l’ancien binaire doit bénéficier de cette mise à jour</em>).</li><li>Pour des raisons de sécurité, l’utilisateur « Pierre » ne doit pas être affiché (<em>l’ancien binaire doit bénéficier de cette mise à jour</em>).</li><li>La fonction <strong>getLoggedUsers</strong>() doit retourner le nombre d’utilisateurs. Pour cela l’ABI de la fonction doit changer (<em>obligation de passer à la version 2.0.0 de la bibliothèque</em>).</li><li>Introduire la possibilité de filtrer sur un seul utilisateur.</li></ul><p>Avec ce simple exemple, on se retrouve contraint de maintenir plusieurs versions de la bibliothèque, ce qui n’est pas possible (<em>les anciens binaires ne vont bénéficier d’aucune mise à jour</em>).</p><p>La prochaine release (<em>incompatible avec l’ancien binaire</em>) sera comme ceci :</p><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/no_method_build_fail/libusrmgr.so.2.0.0/usrmgr.h">usrmgr.h :</a> fichier header de la bibliothèque « <strong>libusrmgr.so.2.0.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include <stdlib.h></span>
<span style="color: #557799">#include <utmpx.h></span>
<span style="color: #557799">#include <time.h></span>
<span style="color: #557799">#include <string.h></span>

<span style="color: #557799">#define HIDDEN_USER "Pierre"</span>

<span style="color: #888888">/* Affiche et retourne le nombre des utilisateurs connectés */</span>
<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getLoggedUsers</span>(<span style="color: #333399;font-weight: bold">char</span> filterUser[]);
</pre></div><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/no_method_build_fail/libusrmgr.so.2.0.0/usrmgr.c">usrmgr.c :</a> implémentation de la bibliothèque « <strong>libusrmgr.so.2.0.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "usrmgr.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getLoggedUsers</span>(<span style="color: #333399;font-weight: bold">char</span> filterUser[]){
    <span style="color: #333399;font-weight: bold">int</span> usr_nb <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    <span style="color: #008800;font-weight: bold">struct</span> utmpx <span style="color: #333333">*</span>utmpUser;
    setutxent(); <span style="color: #888888">// Ouverture du fichier /var/run/utmp</span>

    <span style="color: #888888">/* Parcours de la liste des utilisateurs */</span>
    <span style="color: #008800;font-weight: bold">while</span> ((utmpUser <span style="color: #333333">=</span> getutxent()) <span style="color: #333333">!=</span> <span style="color: #007020">NULL</span>) {
        <span style="color: #008800;font-weight: bold">if</span>(strcmp(utmpUser<span style="color: #333333">-></span>ut_user, HIDDEN_USER) <span style="color: #333333">==</span> <span style="color: #0000DD;font-weight: bold">0</span>){
            <span style="color: #888888">// Reprendre au début de la boucle pour ne pas inclure l'utilisateur.</span>
            <span style="color: #008800;font-weight: bold">continue</span>;
        }
        usr_nb<span style="color: #333333">++</span>;
        <span style="color: #008800;font-weight: bold">if</span>(strcmp(utmpUser<span style="color: #333333">-></span>ut_user,filterUser) <span style="color: #333333">==</span> <span style="color: #0000DD;font-weight: bold">0</span>){ <span style="color: #888888">// Si filtre utilisateur</span>
             printf(<span style="background-color: #fff0f0">"Filtre utilisateur : %s <=> PID : %ld at : %s est connecté!</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>,
                utmpUser<span style="color: #333333">-></span>ut_user, (<span style="color: #333399;font-weight: bold">long</span>) utmpUser<span style="color: #333333">-></span>ut_pid,
                ctime((<span style="color: #333399;font-weight: bold">time_t</span> <span style="color: #333333">*</span>) <span style="color: #333333">&</span>(utmpUser<span style="color: #333333">-></span>ut_tv.tv_sec)));
            <span style="color: #008800;font-weight: bold">break</span>;
        } <span style="color: #008800;font-weight: bold">else</span> <span style="color: #008800;font-weight: bold">if</span>(strcmp(filterUser,<span style="background-color: #fff0f0">""</span>) <span style="color: #333333">==</span> <span style="color: #0000DD;font-weight: bold">0</span>){
             printf(<span style="background-color: #fff0f0">"Utilisateur : %s <=> PID : %ld at : %s</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, utmpUser<span style="color: #333333">-></span>ut_user,
                (<span style="color: #333399;font-weight: bold">long</span>) utmpUser<span style="color: #333333">-></span>ut_pid, ctime((<span style="color: #333399;font-weight: bold">time_t</span> <span style="color: #333333">*</span>) <span style="color: #333333">&</span>(utmpUser<span style="color: #333333">-></span>ut_tv.tv_sec)));
        }
    }

    endutxent(); <span style="color: #888888">// Fermer le fichier /var/run/utmp</span>
    <span style="color: #008800;font-weight: bold">return</span> usr_nb;
}
</pre></div><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/no_method_build_fail/libusrmgr.so.2.0.0/deuxiemeBinaire.c">deuxiemeBinaire.c :</a> le binaire doit être mis à jour comme ceci :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "usrmgr.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(){
    printf(<span style="background-color: #fff0f0">"La liste des utilisateurs connectés : </span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>);
    getLoggedUsers(<span style="background-color: #fff0f0">""</span>);

    printf(<span style="background-color: #fff0f0">"</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">Filtrer sur l'utilisateur 'jugurtha' : </span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>);
    getLoggedUsers(<span style="background-color: #fff0f0">"jugurtha"</span>);

    <span style="color: #008800;font-weight: bold">return</span> EXIT_SUCCESS;
}
</pre></div><p>La compilation et l’exécution du nouveau binaire sont réalisées comme suit :</p><ul class="wp-block-gallery aligncenter columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to.png" alt="" data-id="7052" data-link="https://www.linuxembedded.fr/?attachment_id=7052" class="wp-image-7052 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to.png 798w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to-300x148.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to-768x378.png 768w" sizes="(max-width: 798px) 100vw, 798px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to.png" alt="" data-id="7052" data-link="https://www.linuxembedded.fr/?attachment_id=7052" class="lazyload wp-image-7052 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to.png 798w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to-300x148.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_fail_to-768x378.png 768w" data-sizes="(max-width: 798px) 100vw, 798px"></figure></li></ul><p>Il est temps d’essayer d’exécuter l’ancien binaire (<em>qu’il faut copier dans le répertoire ou se trouve libusrmgr.so.2.0.0</em>) avec la nouvelle bibliothèque :</p><ul class="wp-block-gallery aligncenter columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib.png" alt="" data-id="7053" data-link="https://www.linuxembedded.fr/?attachment_id=7053" class="wp-image-7053 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib.png 797w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib-300x24.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib-768x61.png 768w" sizes="(max-width: 797px) 100vw, 797px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib.png" alt="" data-id="7053" data-link="https://www.linuxembedded.fr/?attachment_id=7053" class="lazyload wp-image-7053 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib.png 797w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib-300x24.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/failed_to_load_previous_lib-768x61.png 768w" data-sizes="(max-width: 797px) 100vw, 797px"></figure></li></ul><div style="text-align:center;background-color:#6DD5FA11;padding : 2px"><h3 style="text-align:center;font-weight:bold">Important</h3><p>L’utilitaire <strong>ldd</strong> permet de lister les bibliothèques importées par une application. Voici le résultat de la commande sur nos deux programmes :</p><div style="text-align:center"><figure class="wp-block-image"><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure.png" alt="" class="wp-image-7073 img-fluid" width="95%" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure.png 804w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure-300x81.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure-768x206.png 768w" sizes="(max-width: 804px) 100vw, 804px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure.png" alt="" class="lazyload wp-image-7073 img-fluid" width="95%" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure.png 804w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure-300x81.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/ldd_shows_lib_failure-768x206.png 768w" data-sizes="(max-width: 804px) 100vw, 804px"></figure></div><p>On peut voir clairement que le chemin vers la bibliothèque « libusrmgr.so.1.0.0 » n’est pas <br>résolu (<em>pour le premier binaire</em>).</p></div><p style="text-align:center"><span style="color:red">C’est cela qu’on appelle le problème de version des bibliothèques partagées. </span><strong>Une notion méconnue de certains développeurs.</strong></p><h2>Gérer le versionnement de ses bibliothèques</h2><p>Il existe deux méthodes très appréciées en pratique :</p><ul><li><strong>Méthode du lien symbolique de type « soname » :</strong> se limite aux changements mineurs et aux patchs (<em>donc les nombres mineur et patch d’une version d’une bibliothèque</em>).</li><li><strong>Méthode « gestion de symboles » :</strong> plus puissante (<em>et un peu plus complexe</em>) que la précédente mais permet de gérer tout type de changement en gardant une rétrocompabilité irréprochable (<em>résiste même au changement de l’ABI et des interfaces</em>). C’est cette méthode qu’utilise la fameuse bibliothèque <a href="https://akkadia.org/drepper/symbol-versioning">glibc</a>.</li></ul><h3>La méthode du lien type « soname »</h3><p>Cette méthode part du principe de réduction des informations de versionnage qui apparaissent dans le nom des bibothèques partagées.</p><p>Pour cela le binaire est compilé avec un lien symbolique intermédiaire (<em>appelé le lien « soname »</em>) qui ne contient que le nombre majeur comme information de versionnage (<em>qui lui même fait référence à la vraie bibliothèque</em>). La figure suivante illustre le processus :</p><ul class="wp-block-gallery columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1.png" alt="" data-id="6821" data-link="http://www.linuxembedded.fr/?attachment_id=6821" class="wp-image-6821 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1.png 881w,https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1-300x157.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1-768x403.png 768w" sizes="(max-width: 881px) 100vw, 881px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1.png" alt="" data-id="6821" data-link="http://www.linuxembedded.fr/?attachment_id=6821" class="lazyload wp-image-6821 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1.png 881w, https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1-300x157.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-1-768x403.png 768w" data-sizes="(max-width: 881px) 100vw, 881px"></figure></li></ul><p>Comme le montre clairement le schéma précédent, plus besoin de recompiler le binaire pour référencer la nouvelle version de la bibliothèque. On peut encore aller plus loin, un lien symbolique (<em>optionnel mais recommandé par convention</em>) peut être inséré entre le binaire et le lien symbolique de type soname. Cela permet de compiler le binaire d’une manière générique : <code>$ gcc -ltestbiblio</code> … à la place de <code>$ gcc -l:libtestbiblio.so.1.</code></p><p>Le schéma final qui décrit la méthode soname est le suivant :</p><ul class="wp-block-gallery columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1.png" alt="" data-id="6824" data-link="http://www.linuxembedded.fr/?attachment_id=6824" class="wp-image-6824 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1.png 976w,https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1-300x197.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1-768x504.png 768w" sizes="(max-width: 976px) 100vw, 976px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1.png" alt="" data-id="6824" data-link="http://www.linuxembedded.fr/?attachment_id=6824" class="lazyload wp-image-6824 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1.png 976w, https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1-300x197.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/09/soname-based_method-1-768x504.png 768w" data-sizes="(max-width: 976px) 100vw, 976px"></figure></li></ul><p>Ce qui fait maintenant que tous les binaires (<em>tant que le nombre majeur n’est pas changé</em>) peuvent fonctionner avec la nouvelle bibliothèque sans avoir à les recompiler.</p><h4>Exemple 1 : release de la bibliothèque libfilemanager.so.1.0.0</h4><p>Nous prendrons comme exemple une simple bibliothèque qui affiche les statistiques d’un fichier.</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/soname_method/libfilemanager.so.1.0.0/filemanager.h">filemanager.h</a> :</strong> header de la bibliothèque <strong>« libfilemanager.so.1.0.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <sys/types.h></span>
<span style="color: #557799">#include <sys/stat.h></span>
<span style="color: #557799">#include <unistd.h></span>
<span style="color: #557799">#include <stdio.h></span>

<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getFileStats</span>(<span style="color: #008800;font-weight: bold">const</span> <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> filePath);
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/soname_method/libfilemanager.so.1.0.0/filemanager.c">filemanager.c</a> :</strong> implémentation de la bibliothèque <strong>« filemanager.so.1.0.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "filemanager.h"</span>

<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getFileStats</span>(<span style="color: #008800;font-weight: bold">const</span> <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> filePath){
    <span style="color: #008800;font-weight: bold">struct</span> stat fileStat;
    <span style="color: #333399;font-weight: bold">int</span> fileError <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    
    fileError <span style="color: #333333">=</span> stat(filePath, <span style="color: #333333">&</span>fileStat);

    <span style="color: #008800;font-weight: bold">if</span>(fileError <span style="color: #333333"><</span> <span style="color: #0000DD;font-weight: bold">0</span>){
        perror(<span style="background-color: #fff0f0">"erreur fonction stat"</span>);
        <span style="color: #008800;font-weight: bold">return</span>;
    }
    <span style="color: #888888">// Check if the provided file is a regular file</span>
    <span style="color: #008800;font-weight: bold">if</span>((fileStat.st_mode <span style="color: #333333">&</span> S_IFMT) <span style="color: #333333">==</span> S_IFREG)
        printf(<span style="background-color: #fff0f0">"Nom du Fichier %s => Taille : %ld bytes</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, filePath, fileStat.st_size);
    <span style="color: #008800;font-weight: bold">else</span>
        printf(<span style="background-color: #fff0f0">"Le fichier n'est pas de type S_IFREG</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>);
}
</pre></div><p>La compilation et la création du lien symbolique doivent se faire comme ceci :</p><ul class="wp-block-gallery aligncenter columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1.png" alt="" data-id="6708" data-link="http://www.linuxembedded.fr/?attachment_id=6708" class="wp-image-6708 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1.png 878w,https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1-300x32.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1-768x83.png 768w" sizes="(max-width: 878px) 100vw, 878px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1.png" alt="" data-id="6708" data-link="http://www.linuxembedded.fr/?attachment_id=6708" class="lazyload wp-image-6708 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1.png 878w, https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1-300x32.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_compilation-1-768x83.png 768w" data-sizes="(max-width: 878px) 100vw, 878px"></figure></li></ul><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/soname_method/libfilemanager.so.1.0.0/premierClient.c">premierClient.c :</a></strong> implémentation du binaire client <strong>« premierClient »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "filemanager.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(<span style="color: #333399;font-weight: bold">int</span> argc, <span style="color: #333399;font-weight: bold">char</span> <span style="color: #333333">*</span>argv[]){
    
    <span style="color: #008800;font-weight: bold">if</span>(argc <span style="color: #333333"><</span><span style="color: #0000DD;font-weight: bold">2</span>){
        printf(<span style="background-color: #fff0f0">"Usage : %s <Nom_Fichier></span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, argv[<span style="color: #0000DD;font-weight: bold">0</span>]);
        <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">1</span>;    
    }
    <span style="color: #888888">// Get file statistics        </span>
    getFileStats(argv[<span style="color: #0000DD;font-weight: bold">1</span>]);

    <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">0</span>;
}
</pre></div><div class="wp-block-image"><figure class="aligncenter"><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode.png" alt="" class="wp-image-6710 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode.png 879w,https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode-300x54.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode-768x137.png 768w" sizes="(max-width: 879px) 100vw, 879px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode.png" alt="" class="lazyload wp-image-6710 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode.png 879w, https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode-300x54.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/08/soname_client_compilation_mode-768x137.png 768w" data-sizes="(max-width: 879px) 100vw, 879px"></figure></div><h4>Exemple 2 : release de la bibliothèque libfilemanager.so.1.1.0</h4><p>Après quelque temps, on se rend compte qu’il est nécessaire d’avoir une fonction pour lister les fichiers contenus dans un dossier, on doit introduire l’interface <strong>« getFilesInFolder</strong> » et faire une nouvelle release <strong>« libfilemanager.so.1.1.0 »</strong>.</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/soname_method/libfilemanager.so.1.1.0/filemanager.h">filemanager.h :</a></strong> header de la bibliothèque <strong>« libfilemanager.so.1.1.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <sys/types.h></span>
<span style="color: #557799">#include <sys/stat.h></span>
<span style="color: #557799">#include <unistd.h></span>
<span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include <dirent.h></span>

<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getFileStats</span>(<span style="color: #008800;font-weight: bold">const</span> <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> filePath);

<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getFilesInFolder</span>(<span style="color: #008800;font-weight: bold">const</span> <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> folderPath);
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/soname_method/libfilemanager.so.1.1.0/filemanager.c">filemanager.c :</a></strong> implémentation de la bibliothèque <strong>« filemanager.so.1.1.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "filemanager.h"</span>

<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getFileStats</span>(<span style="color: #008800;font-weight: bold">const</span> <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> filePath){
    <span style="color: #008800;font-weight: bold">struct</span> stat fileStat;
    <span style="color: #333399;font-weight: bold">int</span> fileError <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    
    fileError <span style="color: #333333">=</span> stat(filePath, <span style="color: #333333">&</span>fileStat);

    <span style="color: #008800;font-weight: bold">if</span>(fileError <span style="color: #333333"><</span> <span style="color: #0000DD;font-weight: bold">0</span>){
        perror(<span style="background-color: #fff0f0">"erreur fonction stat"</span>);
        <span style="color: #008800;font-weight: bold">return</span>;
    }
    <span style="color: #888888">// Check if the provided file is a regular file</span>
    <span style="color: #008800;font-weight: bold">if</span>((fileStat.st_mode <span style="color: #333333">&</span> S_IFMT) <span style="color: #333333">==</span> S_IFREG)
        printf(<span style="background-color: #fff0f0">"Nom du Fichier %s => Taille : %ld bytes</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, filePath, fileStat.st_size);
    <span style="color: #008800;font-weight: bold">else</span>
        printf(<span style="background-color: #fff0f0">"Le fichier n'est pas de type S_IFREG</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>);
}

<span style="color: #333399;font-weight: bold">void</span> <span style="color: #0066BB;font-weight: bold">getFilesInFolder</span>(<span style="color: #008800;font-weight: bold">const</span> <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> folderPath){
    <span style="color: #333399;font-weight: bold">DIR</span><span style="color: #333333">*</span> folder <span style="color: #333333">=</span> <span style="color: #007020">NULL</span>;
    <span style="color: #008800;font-weight: bold">struct</span> dirent<span style="color: #333333">*</span> fileToRead <span style="color: #333333">=</span> <span style="color: #007020">NULL</span>;
    <span style="color: #333399;font-weight: bold">int</span> fileCounter <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;

    folder <span style="color: #333333">=</span> opendir(folderPath); <span style="color: #888888">// open folder</span>

    <span style="color: #008800;font-weight: bold">if</span> (folder <span style="color: #333333">==</span> <span style="color: #007020">NULL</span>){
        perror(<span style="background-color: #fff0f0">"Fonction opendir"</span>);
        <span style="color: #008800;font-weight: bold">return</span>;
    }
    
    <span style="color: #008800;font-weight: bold">while</span> ((fileToRead <span style="color: #333333">=</span> readdir(folder)) <span style="color: #333333">!=</span> <span style="color: #007020">NULL</span>){
        fileCounter<span style="color: #333333">++</span>;
        <span style="color: #888888">// display discovered files</span>
        printf(<span style="background-color: #fff0f0">"%d - %s</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, fileCounter, fileToRead<span style="color: #333333">-></span>d_name);
    }

    closedir(folder);
}
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/soname_method/libfilemanager.so.1.1.0/dexiemeClient.c">deuxiemeClient.c :</a></strong> implémentation du binaire client <strong>« deuxiemeClient »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "filemanager.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(<span style="color: #333399;font-weight: bold">int</span> argc, <span style="color: #333399;font-weight: bold">char</span> <span style="color: #333333">*</span>argv[]){
    
    <span style="color: #008800;font-weight: bold">if</span>(argc <span style="color: #333333"><</span><span style="color: #0000DD;font-weight: bold">2</span>){
        printf(<span style="background-color: #fff0f0">"Usage : %s <Nom_Dossier></span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, argv[<span style="color: #0000DD;font-weight: bold">0</span>]);
        <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">1</span>;
    }
            
    getFilesInFolder(argv[<span style="color: #0000DD;font-weight: bold">1</span>]);

    <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">0</span>;
}
</pre></div><ul><li>Supprimer l’ancien lien symbolique :</li></ul><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #996633">$ </span>rm -rf libfilemanager.so
</pre></div><ul><li>Recompiler la bibliothèque et créer un nouveau lien de type « soname » comme décrit précédemment (<em>exemple 1</em>).</li></ul><ul><li>Compiler le binaire client :</li></ul><ul class="wp-block-gallery aligncenter columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_name_method_minor_number.png" alt="" data-id="7054" data-link="https://www.linuxembedded.fr/?attachment_id=7054" class="wp-image-7054 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_name_method_minor_number.png 757w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_name_method_minor_number-300x134.png 300w" sizes="(max-width: 757px) 100vw, 757px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_name_method_minor_number.png" alt="" data-id="7054" data-link="https://www.linuxembedded.fr/?attachment_id=7054" class="lazyload wp-image-7054 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_name_method_minor_number.png 757w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_name_method_minor_number-300x134.png 300w" data-sizes="(max-width: 757px) 100vw, 757px"></figure></li></ul><p><strong>N.B :</strong> L’ancien binaire ne sera pas affecté par les changements, le loader va toujours charger libfilemanager.so.1 (<em>qui pointe désormais sur libfilemanager.1.1.0</em>) comme le montre la figure ci-dessous :</p><figure class="wp-block-image"><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_backward_compatible.png" alt="" class="wp-image-7055 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_backward_compatible.png 757w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_backward_compatible-300x185.png 300w" sizes="(max-width: 757px) 100vw, 757px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_backward_compatible.png" alt="" class="lazyload wp-image-7055 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_backward_compatible.png 757w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/soname_backward_compatible-300x185.png 300w" data-sizes="(max-width: 757px) 100vw, 757px"></figure><p>La méthode <strong>« soname »</strong> nous a permis en toute facilité d’apporter des modifications à notre bilbiothèque, le tout en restant compatible avec l’ancien binaire.</p><h3>La méthode « gestion de symboles »</h3><p>Cette méthode est plus puissante et plus complète que la précédente (<em>elle est</em> <em>d’ailleurs utilisée par glibc depuis la version 2.6</em>). En effet, les changements ne sont pas restreints au nombre mineur (<em>et nombre patch</em>) d’une bibliothèque.<br>La méthode « gestion de symboles » s’appuie aussi sur la méthode du lien du type « soname » en garantissant une rétrocompatibilité antérieure pour tout type de modifications.<br>Le schéma vu précédemment peut être redéfini comme suit :</p><div class="wp-block-image"><figure class="aligncenter"><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2.png" alt="" class="wp-image-6986 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2.png 976w,https://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2-300x197.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2-768x504.png 768w" sizes="(max-width: 976px) 100vw, 976px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2.png" alt="" class="lazyload wp-image-6986 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2.png 976w, https://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2-300x197.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/10/soname-based_method-2-768x504.png 768w" data-sizes="(max-width: 976px) 100vw, 976px"></figure></div><p><strong>N.B :</strong> il n’est plus nécéssaire d’avoir un lien symbolique (<em>entre le binaire et le lien de type « soname »</em>) car le nom du lien type « soname » ne contient plus le nombre majeur.</p><p>La méthode « gestion de symboles » introduit deux briques supplémentaires pour combler les limitations de la méthode du lien type « soname » :</p><ul><li><strong>Le gestionnaire de version « linker script » :</strong> fichier parsé par le linker; ce dernier décrit les fonctions, leurs versions (<em>en indiquant la version à utiliser pour les anciennes et les prochaines versions de la bibliothèque</em>) et  leur visibilité (<em>les fonctions à exporter au binaire du client</em>).<br><strong>N.B :</strong> le gestionnaire de version est suffisant pour gérer les changements sur les nombres mineur et patch.</li><li><strong>la directive « .symver » (<em>directive supportée par GCC</em>) :</strong> utilisée lors d’une altération du prototype d’une fonction (<em>incluant une mise à jour du nombre majeur de la bibliothèque</em>).<br><strong>N.B :</strong> cette directive n’est introduite que lors d’un changement de la définition des interfaces (<em>c’est à dire la mise à jour du nombre majeur</em>).</li></ul><p>Comme dans le cas des parties précédentes, nous partirons sur un exemple qui va évoluer au fur et à mesure.</p><h4>Exemple 1 : première release de la bibliothèque libnbgenerator.so.1.0.0</h4><p>Pour les besoins d’une gestion de mot de passe, nous implémentons une bibliothèque qui peut générer des nombres pseudo-aléatoires.</p><p>Une simple implémentation peut être la suivante :</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/first_client/nbgenerator.h">nbgenerator.h :</a></strong> header de la bibliothèque <strong>« libnbgenerator.so.1.0.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include <stdlib.h></span>
<span style="color: #557799">#include <time.h></span>

<span style="color: #557799">#define DEFAULT_MAX_NUMBER_LIMIT 1000</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getPseudoNumber</span>(<span style="color: #333399;font-weight: bold">int</span> numLimit);
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/first_client/nbgenerator.c">nbgenerator.c :</a></strong> implémentation de la bibliothèque « <strong>libnbgenerator.so.1.0.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "nbgenerator.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getPseudoNumber</span>(<span style="color: #333399;font-weight: bold">int</span> numLimit){
    <span style="color: #333399;font-weight: bold">int</span> rNumber <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    srand(time(<span style="color: #007020">NULL</span>));
    <span style="color: #008800;font-weight: bold">if</span>(numLimit <span style="color: #333333">></span> <span style="color: #0000DD;font-weight: bold">0</span>)
        rNumber <span style="color: #333333">=</span> rand() <span style="color: #333333">%</span> numLimit;
    <span style="color: #008800;font-weight: bold">else</span>
        rNumber <span style="color: #333333">=</span> rand() <span style="color: #333333">%</span> DEFAULT_MAX_NUMBER_LIMIT;
    <span style="color: #008800;font-weight: bold">return</span> rNumber;
}
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/first_client/script_version">script_version :</a></strong> et enfin le « linker script » pour assister le linker à la création d’une bibliothèque conforme à la méthode « gestion de symboles ». Dans ce cas, il indique que seul <strong>getPseudoNumber</strong> sera exporté et vu par le binaire du client.</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%">NBGENERATOR_1.0<span style="color: #333333">{</span>
    <span style="color: #007020">global</span>:
        getPseudoNumber;
    <span style="color: #007020">local</span>:
        *;
<span style="color: #333333">}</span>;
</pre></div><p><strong>N.B :</strong> généralement il est n’est pas nécessaire d’inclure le nombre patch dans le « linker script » car ce genre de changement n’impacte pas la rétrocompatibilité (<em>NBGENERATOR_1.0 n’est qu’un symbole dans l’entête de la bibliothèque comme on verra par la suite</em>) ; cependant, on peut très bien écrire <strong>NBGENERATOR_1.0.0</strong>.</p><p>la compilation de la bibliothèque se fera de la manière suivante :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%">PC@PC ~ <span style="color: #996633">$ </span>gcc -Wall -fPIC -c nbgenerator.c
PC@PC ~ <span style="color: #996633">$ </span>gcc -shared nbgenerator.o -Wl,-soname,libnbgenerator.so -Wl,--version-script,script_version -o libnbgenerator.so.1.0.0
PC@PC ~ <span style="color: #996633">$ </span>ldconfig -n .
</pre></div><p><strong>Remarque :</strong> Il est obligatoire de passer « -Wl, option » comme option de compilation pour modifier le comportement du linker (<em>pour tenir compte du fichier de version « linker script »</em>).</p><p>Grâce au « linker script », le linker insère 3 sections dans l’entête de la bibliothèque comme le montre la figure suivante :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #996633">$ </span>readelf -V nbgenerator.so

Version symbols section <span style="background-color: #fff0f0">'.gnu.version'</span> contains 12 entries:
 Addr: 00000000000003f2  Offset: 0x0003f2  Link: 3 <span style="color: #333333">(</span>.dynsym<span style="color: #333333">)</span>
  000:   0 <span style="color: #333333">(</span>*local*<span style="color: #333333">)</span>       0 <span style="color: #333333">(</span>*local*<span style="color: #333333">)</span>       0 <span style="color: #333333">(</span>*local*<span style="color: #333333">)</span>       3 <span style="color: #333333">(</span>GLIBC_2.2.5<span style="color: #333333">)</span>
  004:   0 <span style="color: #333333">(</span>*local*<span style="color: #333333">)</span>       3 <span style="color: #333333">(</span>GLIBC_2.2.5<span style="color: #333333">)</span>   0 <span style="color: #333333">(</span>*local*<span style="color: #333333">)</span>       0 <span style="color: #333333">(</span>*local*<span style="color: #333333">)</span>    
  008:   3 <span style="color: #333333">(</span>GLIBC_2.2.5<span style="color: #333333">)</span>   3 <span style="color: #333333">(</span>GLIBC_2.2.5<span style="color: #333333">)</span>   2 <span style="color: #333333">(</span>NBGENERATOR_1.0<span style="color: #333333">)</span>     2 <span style="color: #333333">(</span>NBGENERATOR_1.0<span style="color: #333333">)</span>  

Version definition section <span style="background-color: #fff0f0">'.gnu.version_d'</span> contains 2 entries:
  Addr: 0x0000000000000410  Offset: 0x000410  Link: 4 <span style="color: #333333">(</span>.dynstr<span style="color: #333333">)</span>  000000: Rev: 1  Flags: BASE   Index: 1  Cnt: 1  Name: nbgenerator.so
  0x001c: Rev: 1  Flags: none  Index: 2  Cnt: 1  Name: NBGENERATOR_1.0
  Version definition past end of section

Version needs section <span style="background-color: #fff0f0">'.gnu.version_r'</span> contains 1 entries:
 Addr: 0x0000000000000448  Offset: 0x000448  Link: 4 <span style="color: #333333">(</span>.dynstr<span style="color: #333333">)</span>
  000000: Version: 1  File: libc.so.6  Cnt: 1
  0x0010:   Name: GLIBC_2.2.5  Flags: none  Version: 3
</pre></div><ul><li><strong>.gnu.version :</strong> contient les informations de version globale.</li><li><strong>.gnu.version_d :</strong> affiche les informations de version relative à cette bibliothèque.</li><li><strong>.gnu.version_r :</strong> permet de suivre les informations de version relatives aux bibliothèques référencées par cette bibliothèque.</li></ul><p><strong>N.B :</strong> ces champs liés à la version seront recopiés dans le binaire du client lors de la compilation, ce qui permettra au loader de charger les bonnes versions de fonctions adaptées pour chaque binaire.</p><p>La bibliothèque est prête, il ne reste plus qu’à créer un client pour l’exploiter.</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/first_client/premierClient.c">premierClient.c :</a></strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/first_client/premierClient.c"> </a>premier binaire client.</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include "nbgenerator.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(){
    printf(<span style="background-color: #fff0f0">"Le nombre aléatoire est %d</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, getPseudoNumber(<span style="color: #0000DD;font-weight: bold">1500</span>));
    <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">0</span>;
}
</pre></div><div class="wp-block-image"><figure class="aligncenter"><noscript><img src="http://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version.png" alt="" class="wp-image-6972 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version.png 1019w,https://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version-300x54.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version-768x137.png 768w" sizes="(max-width: 1019px) 100vw, 1019px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="http://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version.png" alt="" class="lazyload wp-image-6972 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version.png 1019w, https://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version-300x54.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/10/first_library_version-768x137.png 768w" data-sizes="(max-width: 1019px) 100vw, 1019px"></figure></div><h4>Exemple 2 : deuxième release de libnbgenerator.so.1.1.0</h4><p>En plus des nombres pseudo-aléatoires, il est requis d’avoir une interface pour la génération de chaines de caractères contenant des mots de passe.<br>Cela peut se faire comme indiqué :</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/second_client/nbgenerator.h">nbgenerator.h :</a></strong> header de la bibliothèque <strong>« libnbgenerator.so.1.1.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include <stdlib.h></span>
<span style="color: #557799">#include <time.h></span>
<span style="color: #557799">#include <string.h></span>

<span style="color: #557799">#define DEFAULT_MAX_NUMBER_LIMIT 1000</span>
<span style="color: #557799">#define MAX_PASSWORD_LENGTH 20</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getPseudoNumber</span>(<span style="color: #333399;font-weight: bold">int</span> numLimit);

<span style="color: #888888">/* generationMotDePasse has a local symbol */</span>
<span style="color: #333399;font-weight: bold">char</span> <span style="color: #333333">*</span><span style="color: #0066BB;font-weight: bold">generationMotDePasse</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);

<span style="color: #888888">/* generationMotDePasse has a global symbol (exported to client binary) */</span>
<span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #0066BB;font-weight: bold">getRandomPassword</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/second_client/nbgenerator.c">nbgenerator.c :</a></strong> implémentation de la bibliothèque « <strong>libnbgenerator.so.1.1.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "nbgenerator.h"</span>

<span style="color: #333399;font-weight: bold">char</span> password[MAX_PASSWORD_LENGTH] <span style="color: #333333">=</span> {<span style="color: #0000DD;font-weight: bold">0</span>};
<span style="color: #888888">// getPseudoNumber : exported to client binary</span>
<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getPseudoNumber</span>(<span style="color: #333399;font-weight: bold">int</span> numLimit){
    <span style="color: #333399;font-weight: bold">int</span> rNumber <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    srand(time(<span style="color: #007020">NULL</span>));
    <span style="color: #008800;font-weight: bold">if</span>(numLimit <span style="color: #333333">></span> <span style="color: #0000DD;font-weight: bold">0</span>)
        rNumber <span style="color: #333333">=</span> rand() <span style="color: #333333">%</span> numLimit;
    <span style="color: #008800;font-weight: bold">else</span>
        rNumber <span style="color: #333333">=</span> rand() <span style="color: #333333">%</span> DEFAULT_MAX_NUMBER_LIMIT;
    <span style="color: #008800;font-weight: bold">return</span> rNumber;
}
<span style="color: #888888">// generationMotDePasse : not exported to client binary</span>
<span style="color: #333399;font-weight: bold">char</span> <span style="color: #333333">*</span><span style="color: #0066BB;font-weight: bold">generationMotDePasse</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters){
    <span style="color: #333399;font-weight: bold">short</span> i <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    memset(password, <span style="color: #0000DD;font-weight: bold">0</span>, MAX_PASSWORD_LENGTH);
    
    srand(time(<span style="color: #007020">NULL</span>));
    
    <span style="color: #008800;font-weight: bold">if</span>((nbCharacters <span style="color: #333333">></span> MAX_PASSWORD_LENGTH) <span style="color: #333333">||</span> (nbCharacters <span style="color: #333333"><=</span> <span style="color: #0000DD;font-weight: bold">0</span>))
        nbCharacters <span style="color: #333333">=</span> MAX_PASSWORD_LENGTH;
    <span style="color: #888888">/* Génération du mot de passe */</span>
    <span style="color: #008800;font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>; i<span style="color: #333333"><</span> nbCharacters; i<span style="color: #333333">++</span>){
        password[i] <span style="color: #333333">=</span> <span style="color: #0044DD">'A'</span> <span style="color: #333333">+</span> (rand() <span style="color: #333333">%</span> nbCharacters);
    }
    <span style="color: #008800;font-weight: bold">return</span> password;
}
<span style="color: #888888">// getRandomPassword : exported to client binary</span>
<span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #0066BB;font-weight: bold">getRandomPassword</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters){
    <span style="color: #008800;font-weight: bold">return</span> generationMotDePasse(nbCharacters);
}
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/second_client/script_version">script_version :</a></strong> Seules 2 des 3 fonctions seront exportées vers le binaire du client (<strong><em>getPseudoNumber()</em></strong><em> et </em><strong><em>getRandomPassword()</em></strong>) .</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%">NBGENERATOR_1.0<span style="color: #333333">{</span>
    <span style="color: #007020">global</span>:
        getPseudoNumber;
    <span style="color: #007020">local</span>:
        *;
<span style="color: #333333">}</span>;

NBGENERATOR_1.1<span style="color: #333333">{</span>
    <span style="color: #007020">global</span>:
        getRandomPassword;
    <span style="color: #007020">local</span>:
        *;
<span style="color: #333333">}</span>;
</pre></div><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/second_client/dexiemeClient.c">deuxiemeClient.c :</a></strong> deuxième version du binaire du client</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include "nbgenerator.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(){
    printf(<span style="background-color: #fff0f0">"Le nombre aléatoire est %d</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, getPseudoNumber(<span style="color: #0000DD;font-weight: bold">1500</span>));
    printf(<span style="background-color: #fff0f0">"Le mot de passe : %s</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, getRandomPassword(<span style="color: #0000DD;font-weight: bold">10</span>));
    <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">0</span>;
}
</pre></div><p>la compilation se fait comme indiqué ci dessous :</p><figure class="wp-block-image"><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library.png" alt="" class="wp-image-7057 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library.png 836w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library-300x120.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library-768x308.png 768w" sizes="(max-width: 836px) 100vw, 836px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library.png" alt="" class="lazyload wp-image-7057 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library.png 836w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library-300x120.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/linker_script_dynamic_library-768x308.png 768w" data-sizes="(max-width: 836px) 100vw, 836px"></figure><p>Il est temps de tester l’ancien programme sans le recompiler :</p><ul class="wp-block-gallery columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible.png" alt="" data-id="7058" data-link="https://www.linuxembedded.fr/?attachment_id=7058" class="wp-image-7058 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible.png 838w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible-300x40.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible-768x103.png 768w" sizes="(max-width: 838px) 100vw, 838px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible.png" alt="" data-id="7058" data-link="https://www.linuxembedded.fr/?attachment_id=7058" class="lazyload wp-image-7058 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible.png 838w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible-300x40.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/symbol_method_name_back_compatible-768x103.png 768w" data-sizes="(max-width: 838px) 100vw, 838px"></figure></li></ul><h4>Exemple 3 : troisième release de libnbgenerator.so.2.0.0</h4><p>Il arrive parfois que la définition des interfaces soit modifiée (<em>on dit souvent une altération de l’ABI</em>). Sans la méthode « <strong>gestion de symboles</strong>« , ce genre de changement garantit de casser la rétro-compatibilité (<em>c’est le cas d’une fonction qui ne retourne plus le même type ou pire encore, une interface qui doit être retirée de l’usage dans les nouveaux binaire</em>s).</p><p>Dans le cas de notre bibliothèque, on se retrouve vite limité par la fonction <strong>getRandomPassword</strong>() qui doit retourner en plus du mot de passe en clair, le <strong>mot de passe hashé</strong> et la <strong>fonction de hash</strong>.</p><p style="text-align:center">La question qui se pose est comment faire compiler le code suivant :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #888888">// Ancien binaire</span>
<span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #0066BB;font-weight: bold">getRandomPassword</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);

<span style="color: #888888">// Nouveau binaire</span>
<span style="color: #008800;font-weight: bold">struct</span> PasswordHash <span style="color: #0066BB;font-weight: bold">getRandomPassword</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);
</pre></div><p>La réponse est la suivante :</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/third_client/nbgenerator.h">nbgenerator.h :</a></strong> header de la bibliothèque <strong>« libnbgenerator.so.2.0.0 »</strong> :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include <stdlib.h></span>
<span style="color: #557799">#include <time.h></span>
<span style="color: #557799">#include <string.h></span>
<span style="color: #557799">#define _XOPEN_SOURCE</span>
<span style="color: #557799">#include <unistd.h></span>
<span style="color: #557799">#include <crypt.h></span>

<span style="color: #557799">#define DEFAULT_MAX_NUMBER_LIMIT 1000</span>
<span style="color: #557799">#define MAX_PASSWORD_LENGTH 20</span>
<span style="color: #557799">#define ENCRYPTION_CIPHER_METHOD "crypt"</span>

<span style="color: #008800;font-weight: bold">struct</span> PasswordHash{
    <span style="color: #333399;font-weight: bold">char</span> hashNameFunc[<span style="color: #0000DD;font-weight: bold">20</span>];
    <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> passwordToHash;
    <span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> hashedPassword;
} passHash;

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getPseudoNumber</span>(<span style="color: #333399;font-weight: bold">int</span> numLimit);
<span style="color: #333399;font-weight: bold">char</span> <span style="color: #333333">*</span><span style="color: #0066BB;font-weight: bold">generationMotDePasse</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);

<span style="color: #888888">/* LIB_NBGENERATOR_VERSION_2_0 : Constant to be passed at compilation time */</span>
<span style="color: #888888">/* Because only one header is allowed in case of same function signature */</span>
<span style="color: #557799">#ifdef LIB_NBGENERATOR_VERSION_2_0</span>
<span style="color: #008800;font-weight: bold">struct</span> PasswordHash <span style="color: #0066BB;font-weight: bold">getRandomPassword</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);
<span style="color: #557799">#else</span>
<span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #0066BB;font-weight: bold">getRandomPassword</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters);
<span style="color: #557799">#endif</span>
</pre></div><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/third_client/nbgenerator.c">nbgenerator.c :</a> implémentation de la bibliothèque « <strong>libnbgenerator.so.2.0.0</strong> » :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include "nbgenerator.h"</span>

<span style="color: #333399;font-weight: bold">char</span> password[MAX_PASSWORD_LENGTH] <span style="color: #333333">=</span> {<span style="color: #0000DD;font-weight: bold">0</span>};

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">getPseudoNumber</span>(<span style="color: #333399;font-weight: bold">int</span> numLimit){
    <span style="color: #333399;font-weight: bold">int</span> rNumber <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    srand(time(<span style="color: #007020">NULL</span>));
    <span style="color: #008800;font-weight: bold">if</span>(numLimit <span style="color: #333333">></span> <span style="color: #0000DD;font-weight: bold">0</span>)
        rNumber <span style="color: #333333">=</span> rand() <span style="color: #333333">%</span> numLimit;
    <span style="color: #008800;font-weight: bold">else</span>
        rNumber <span style="color: #333333">=</span> rand() <span style="color: #333333">%</span> DEFAULT_MAX_NUMBER_LIMIT;
    <span style="color: #008800;font-weight: bold">return</span> rNumber;
}

<span style="color: #888888">// generationMotDePasse : not exported to client binary</span>
<span style="color: #333399;font-weight: bold">char</span> <span style="color: #333333">*</span><span style="color: #0066BB;font-weight: bold">generationMotDePasse</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters){
    <span style="color: #333399;font-weight: bold">short</span> i <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>;
    memset(password, <span style="color: #0000DD;font-weight: bold">0</span>, MAX_PASSWORD_LENGTH);
    
    srand(time(<span style="color: #007020">NULL</span>));
    
    <span style="color: #008800;font-weight: bold">if</span>((nbCharacters <span style="color: #333333">></span> MAX_PASSWORD_LENGTH) <span style="color: #333333">||</span> (nbCharacters <span style="color: #333333"><=</span> <span style="color: #0000DD;font-weight: bold">0</span>))
        nbCharacters <span style="color: #333333">=</span> MAX_PASSWORD_LENGTH;
    <span style="color: #888888">/* Génération du mot de passe */</span>
    <span style="color: #008800;font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #0000DD;font-weight: bold">0</span>; i<span style="color: #333333"><</span> nbCharacters; i<span style="color: #333333">++</span>){
        password[i] <span style="color: #333333">=</span> <span style="color: #0044DD">'A'</span> <span style="color: #333333">+</span> (rand() <span style="color: #333333">%</span> nbCharacters);
    }
    <span style="color: #008800;font-weight: bold">return</span> password;
}

<span style="color: #888888">/* @ means use this for legacy (old binaries) */</span>
__asm__(<span style="background-color: #fff0f0">".symver getRandomPassword_1_1,getRandomPassword@NBGENERATOR_1.1"</span>);
<span style="color: #333399;font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #0066BB;font-weight: bold">getRandomPassword_1_1</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters){
    <span style="color: #008800;font-weight: bold">return</span> generationMotDePasse(nbCharacters);
}

<span style="color: #888888">/* @@ means default use this for new binaries */</span>
__asm__(<span style="background-color: #fff0f0">".symver getRandomPassword_2_0,getRandomPassword@@NBGENERATOR_2.0"</span>);
<span style="color: #008800;font-weight: bold">struct</span> PasswordHash <span style="color: #0066BB;font-weight: bold">getRandomPassword_2_0</span>(<span style="color: #333399;font-weight: bold">int</span> nbCharacters){
    <span style="color: #333399;font-weight: bold">char</span> passwordToHash[MAX_PASSWORD_LENGTH];
    <span style="color: #333399;font-weight: bold">char</span> passwordSalt[<span style="color: #0000DD;font-weight: bold">6</span>];
    
    strcpy(passwordToHash, generationMotDePasse(<span style="color: #0000DD;font-weight: bold">10</span>));
    
    <span style="color: #888888">// $1$ allows to select md5 hashing algorithm    </span>
    sprintf(passwordSalt, <span style="background-color: #fff0f0">"$6$%s"</span>, generationMotDePasse(<span style="color: #0000DD;font-weight: bold">6</span>));

    sprintf(passHash.hashNameFunc, <span style="background-color: #fff0f0">"%s"</span>, ENCRYPTION_CIPHER_METHOD);
    
    <span style="color: #888888">/* Crypt returns a hash based on DES encryption */</span>
    passHash.hashedPassword <span style="color: #333333">=</span> crypt(passwordToHash, passwordSalt);

    <span style="color: #008800;font-weight: bold">return</span> passHash;
}
</pre></div><p>Le code nécessite quelques petites remarques :</p><ul><li>Les deux fonctions getRandomPassword doivent être déclarées avec des noms différents (<em>par exemple </em><strong><em>getRandomPassword_1_1</em></strong><em>() pour la fonction </em><strong><em>getRandomPassword()</em></strong><em> associée au symbole </em><strong><em>NBGENERATOR_1.1</em></strong>). La directive symver est employée pour faire le mapping.</li><li> Le symbole @ se traduit par : appliquer cette régle à tout ancien binaire contrairement au @@ qui force le linker à utiliser cette fonction avec tous les nouveaux binaires qui seront compilés ultérieurement.</li></ul><p><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/third_client/script_version">script_version :</a> Il nous faut juste insérer le tag NBGENERATOR_2.0 dans le linker script :</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%">NBGENERATOR_1.0<span style="color: #333333">{</span>
    <span style="color: #007020">global</span>:
        getPseudoNumber;
    <span style="color: #007020">local</span>:
        *;
<span style="color: #333333">}</span>;

NBGENERATOR_1.1<span style="color: #333333">{</span>
    <span style="color: #007020">global</span>:
        getRandomPassword;
    <span style="color: #007020">local</span>:
        *;
<span style="color: #333333">}</span>;

NBGENERATOR_2.0<span style="color: #333333">{</span>
    <span style="color: #007020">global</span>:
        getRandomPassword;
    <span style="color: #007020">local</span>:
        *;
<span style="color: #333333">}</span>;
</pre></div><p>Et enfin, la dernière pièce de puzzle qui permet de tester notre bibliothèque, le troisième client :</p><p><strong><a href="https://github.com/jugurthab/linux_embedded_articles/blob/master/library-versioning/symbol_versioning_method/third_client/troisiemeClient.c">troisiemeClient.c :</a></strong> troisième binaire client.</p><div style="background: #ffffff;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0;line-height: 125%"><span style="color: #557799">#include <stdio.h></span>
<span style="color: #557799">#include "nbgenerator.h"</span>

<span style="color: #333399;font-weight: bold">int</span> <span style="color: #0066BB;font-weight: bold">main</span>(){
    <span style="color: #008800;font-weight: bold">struct</span> PasswordHash pass <span style="color: #333333">=</span> getRandomPassword(<span style="color: #0000DD;font-weight: bold">10</span>);
    printf(<span style="background-color: #fff0f0">"Le nombre aléatoire est %d</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>, getPseudoNumber(<span style="color: #0000DD;font-weight: bold">1500</span>));
    printf(<span style="background-color: #fff0f0">"Le mot de passe avec hash : %s avec la fonction => %s</span><span style="color: #666666;font-weight: bold;background-color: #fff0f0">n</span><span style="background-color: #fff0f0">"</span>,
            pass.hashedPassword, pass.hashNameFunc);

    <span style="color: #008800;font-weight: bold">return</span> <span style="color: #0000DD;font-weight: bold">0</span>;
}
</pre></div><p>Il est temps d’exécuter et compiler notre programme :</p><ul class="wp-block-gallery aligncenter columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling.png" alt="" data-id="7091" data-link="https://www.linuxembedded.fr/?attachment_id=7091" class="wp-image-7091 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling.png 787w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling-300x116.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling-768x296.png 768w" sizes="(max-width: 787px) 100vw, 787px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling.png" alt="" data-id="7091" data-link="https://www.linuxembedded.fr/?attachment_id=7091" class="lazyload wp-image-7091 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling.png 787w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling-300x116.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/library_symver_compiling-768x296.png 768w" data-sizes="(max-width: 787px) 100vw, 787px"></figure></li></ul><p>Pour finir, voici l’exécution des trois programmes qui dépendent désormais de <strong>libnbgenerator.2.0.0</strong> :</p><ul class="wp-block-gallery columns-1 is-cropped"><li class="blocks-gallery-item"><figure><noscript><img src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works.png" alt="" data-id="7092" data-link="https://www.linuxembedded.fr/?attachment_id=7092" class="wp-image-7092 img-fluid" srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works.png 789w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works-300x71.png 300w,https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works-768x182.png 768w" sizes="(max-width: 789px) 100vw, 789px"></noscript><img src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20%20%22%3E%3C/svg%3E" data-src="https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works.png" alt="" data-id="7092" data-link="https://www.linuxembedded.fr/?attachment_id=7092" class="lazyload wp-image-7092 img-fluid" data-srcset="https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works.png 789w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works-300x71.png 300w, https://www.linuxembedded.fr/wp-content/uploads/2019/11/all_lib_compilation_works-768x182.png 768w" data-sizes="(max-width: 789px) 100vw, 789px"></figure></li></ul><p style="text-align:center"><strong>Important</strong><br>Il est à noter que la méthode « gestion de symbole » peut augmenter la taille de la bibliothèque générée (<em>comme dans notre exemple avec la présence des deux fonctions getRandomPassword()</em>), c’est l’une des raisons qui rend la glibc volumineuse. Cet inconvénient est souvent négligé par rapport à ses nombreux avantages.</p><h2>Conclusion</h2><p>Dans cet article, nous avons découvert un concept avancé de la gestion des bibliothèques partagées. Il est primordial de concevoir ses bibliothèques avec l’une de ces deux méthodes : le lien type « soname » ou la gestion des symboles (<em>cette dernière est à préconiser</em>).<br>Ces méthodes permettent de maintenir et faire évoluer les bibliothèques, d’améliorer le code et d’apporter des corrections aux failles de sécurité sans avoir à recompiler le binaire du client final (<em>c’est la retro-compatibilité</em>).</p></div></div><div class="clearfix"></div></article><nav class="navigation post-navigation" role="navigation" aria-label="Articles"><h2 class="screen-reader-text">Navigation de l'article</h2><div class="nav-links"><div class="nav-previous"><a href="https://dev-pro.xyz/blog/flamegraph/" rel="prev"><i class="fa fa-angle-double-left" aria-hidden="true"></i> FlameGraph</a></div><div class="nav-next"><a href="https://dev-pro.xyz/blog/storing-crash-data-of-the-linux-kernel-for-post-crash-debugging/" rel="next">Storing crash data of the Linux kernel for post-crash debugging <i class="fa fa-angle-double-right" aria-hidden="true"></i></a></div></div></nav></div></div><div class="col-md-12 col-lg-3 ml-auto"><div class="sidebar my-5"><aside id="recent-posts-2" class="widget widget_recent_entries mb-5"><h3 class="widget-title mt-0">Articles récents</h3><ul><li> <a href="https://dev-pro.xyz/blog/storing-crash-data-of-the-linux-kernel-for-post-crash-debugging/">Storing crash data of the Linux kernel for post-crash debugging</a></li><li> <a href="https://dev-pro.xyz/blog/gestion-de-versions-des-bibliotheques-partagees/" aria-current="page">Gestion de versions des bibliothèques partagées</a></li><li> <a href="https://dev-pro.xyz/blog/flamegraph/">FlameGraph</a></li><li> <a href="https://dev-pro.xyz/blog/le-temps-reel-sous-linux/">Le Temps Reel sous Linux</a></li><li> <a href="https://dev-pro.xyz/blog/my-first-linux-kernel-built-with-clang-compiler/">My first Linux kernel built with Clang compiler!</a></li></ul></aside><aside id="categories-3" class="widget widget_categories mb-5"><h3 class="widget-title mt-0">Catégories</h3><ul><li class="cat-item cat-item-137"><a href="https://dev-pro.xyz/blog/category/actu-linux/" title="Auto Added by WPeMatico">Actu Linux</a></li><li class="cat-item cat-item-145"><a href="https://dev-pro.xyz/blog/category/actualite-mobiles-et-tablettes/" title="Auto Added by WPeMatico">Actualité Mobiles et Tablettes</a></li><li class="cat-item cat-item-143"><a href="https://dev-pro.xyz/blog/category/actualite-windows-os-x-et-linux/" title="Auto Added by WPeMatico">Actualité Windows, OS X et Linux</a></li><li class="cat-item cat-item-151"><a href="https://dev-pro.xyz/blog/category/apple/" title="Auto Added by WPeMatico">Apple</a></li><li class="cat-item cat-item-161"><a href="https://dev-pro.xyz/blog/category/clang/" title="Auto Added by WPeMatico">clang</a></li><li class="cat-item cat-item-174"><a href="https://dev-pro.xyz/blog/category/crash/" title="Auto Added by WPeMatico">crash</a></li><li class="cat-item cat-item-175"><a href="https://dev-pro.xyz/blog/category/crashdump/" title="Auto Added by WPeMatico">crashdump</a></li><li class="cat-item cat-item-169"><a href="https://dev-pro.xyz/blog/category/debug/" title="Auto Added by WPeMatico">debug</a></li><li class="cat-item cat-item-138"><a href="https://dev-pro.xyz/blog/category/distribution-linux/" title="Auto Added by WPeMatico">Distribution Linux</a></li><li class="cat-item cat-item-152"><a href="https://dev-pro.xyz/blog/category/ecouteurs/" title="Auto Added by WPeMatico">Ecouteurs</a></li><li class="cat-item cat-item-158"><a href="https://dev-pro.xyz/blog/category/europe/" title="Auto Added by WPeMatico">Europe</a></li><li class="cat-item cat-item-146"><a href="https://dev-pro.xyz/blog/category/fcc/" title="Auto Added by WPeMatico">FCC</a></li><li class="cat-item cat-item-154"><a href="https://dev-pro.xyz/blog/category/film/" title="Auto Added by WPeMatico">Film</a></li><li class="cat-item cat-item-153"><a href="https://dev-pro.xyz/blog/category/geekeries-et-insolite/" title="Auto Added by WPeMatico">Geekeries et Insolite</a></li><li class="cat-item cat-item-157"><a href="https://dev-pro.xyz/blog/category/hors-sujet/" title="Auto Added by WPeMatico">Hors-Sujet</a></li><li class="cat-item cat-item-160"><a href="https://dev-pro.xyz/blog/category/howto/" title="Auto Added by WPeMatico">HowTo</a></li><li class="cat-item cat-item-147"><a href="https://dev-pro.xyz/blog/category/huawei/" title="Auto Added by WPeMatico">Huawei</a></li><li class="cat-item cat-item-139"><a href="https://dev-pro.xyz/blog/category/info-version/" title="Auto Added by WPeMatico">Info version</a></li><li class="cat-item cat-item-129"><a href="https://dev-pro.xyz/blog/category/installation-logiciel-linux/" title="Auto Added by WPeMatico">Installation Logiciel Linux</a></li><li class="cat-item cat-item-148"><a href="https://dev-pro.xyz/blog/category/justice/" title="Auto Added by WPeMatico">Justice</a></li><li class="cat-item cat-item-162"><a href="https://dev-pro.xyz/blog/category/kernel/" title="Auto Added by WPeMatico">kernel</a></li><li class="cat-item cat-item-176"><a href="https://dev-pro.xyz/blog/category/kexec/" title="Auto Added by WPeMatico">kexec</a></li><li class="cat-item cat-item-171"><a href="https://dev-pro.xyz/blog/category/libc/" title="Auto Added by WPeMatico">libc</a></li><li class="cat-item cat-item-172"><a href="https://dev-pro.xyz/blog/category/linker/" title="Auto Added by WPeMatico">linker</a></li><li class="cat-item cat-item-163"><a href="https://dev-pro.xyz/blog/category/linux/" title="Auto Added by WPeMatico">Linux</a></li><li class="cat-item cat-item-130"><a href="https://dev-pro.xyz/blog/category/linux-mint/" title="Auto Added by WPeMatico">Linux Mint</a></li><li class="cat-item cat-item-140"><a href="https://dev-pro.xyz/blog/category/linux-mint-19-3/" title="Auto Added by WPeMatico">Linux Mint 19.3</a></li><li class="cat-item cat-item-131"><a href="https://dev-pro.xyz/blog/category/machine-virtuelle/" title="Auto Added by WPeMatico">Machine virtuelle</a></li><li class="cat-item cat-item-150"><a href="https://dev-pro.xyz/blog/category/materiel-et-accessoires/" title="Auto Added by WPeMatico">Matériel et Accessoires</a></li><li class="cat-item cat-item-134"><a href="https://dev-pro.xyz/blog/category/messagerie-instantanee/" title="Auto Added by WPeMatico">Messagerie instantanée</a></li><li class="cat-item cat-item-63"><a href="https://dev-pro.xyz/blog/category/microsoft/" title="Auto Added by WPeMatico">Microsoft</a></li><li class="cat-item cat-item-141"><a href="https://dev-pro.xyz/blog/category/mise-a-niveau-linux/" title="Auto Added by WPeMatico">Mise à niveau Linux</a></li><li class="cat-item cat-item-142"><a href="https://dev-pro.xyz/blog/category/mise-a-niveau-linux-mint/" title="Auto Added by WPeMatico">Mise à niveau Linux Mint</a></li><li class="cat-item cat-item-170"><a href="https://dev-pro.xyz/blog/category/perf/" title="Auto Added by WPeMatico">perf</a></li><li class="cat-item cat-item-166"><a href="https://dev-pro.xyz/blog/category/preempt-rt/" title="Auto Added by WPeMatico">preempt-rt</a></li><li class="cat-item cat-item-76"><a href="https://dev-pro.xyz/blog/category/reseaux/" title="Auto Added by WPeMatico">Réseaux</a></li><li class="cat-item cat-item-159"><a href="https://dev-pro.xyz/blog/category/samsung/" title="Auto Added by WPeMatico">Samsung</a></li><li class="cat-item cat-item-135"><a href="https://dev-pro.xyz/blog/category/skype/" title="Auto Added by WPeMatico">Skype</a></li><li class="cat-item cat-item-155"><a href="https://dev-pro.xyz/blog/category/sonic/" title="Auto Added by WPeMatico">Sonic</a></li><li class="cat-item cat-item-173"><a href="https://dev-pro.xyz/blog/category/symboles/" title="Auto Added by WPeMatico">symboles</a></li><li class="cat-item cat-item-164"><a href="https://dev-pro.xyz/blog/category/technologie/" title="Auto Added by WPeMatico">Technologie</a></li><li class="cat-item cat-item-167"><a href="https://dev-pro.xyz/blog/category/temps-reel/" title="Auto Added by WPeMatico">temps réel</a></li><li class="cat-item cat-item-156"><a href="https://dev-pro.xyz/blog/category/trailer/" title="Auto Added by WPeMatico">Trailer</a></li><li class="cat-item cat-item-127"><a href="https://dev-pro.xyz/blog/category/tuto-linux-mint/" title="Auto Added by WPeMatico">Tuto Linux Mint</a></li><li class="cat-item cat-item-128"><a href="https://dev-pro.xyz/blog/category/tuto-ubuntu/" title="Auto Added by WPeMatico">Tuto Ubuntu</a></li><li class="cat-item cat-item-136"><a href="https://dev-pro.xyz/blog/category/tuto-virtualbox/" title="Auto Added by WPeMatico">Tuto VirtualBox</a></li><li class="cat-item cat-item-132"><a href="https://dev-pro.xyz/blog/category/ubuntu/" title="Auto Added by WPeMatico">Ubuntu</a></li><li class="cat-item cat-item-1"><a href="https://dev-pro.xyz/blog/category/uncategorized/">Uncategorized</a></li><li class="cat-item cat-item-149"><a href="https://dev-pro.xyz/blog/category/usa/" title="Auto Added by WPeMatico">USA</a></li><li class="cat-item cat-item-133"><a href="https://dev-pro.xyz/blog/category/virtualbox/" title="Auto Added by WPeMatico">Virtualbox</a></li><li class="cat-item cat-item-177"><a href="https://dev-pro.xyz/blog/category/vmcore/" title="Auto Added by WPeMatico">vmcore</a></li><li class="cat-item cat-item-165"><a href="https://dev-pro.xyz/blog/category/whitepaper/" title="Auto Added by WPeMatico">WhitePaper</a></li><li class="cat-item cat-item-144"><a href="https://dev-pro.xyz/blog/category/windows-10/" title="Auto Added by WPeMatico">Windows 10</a></li><li class="cat-item cat-item-168"><a href="https://dev-pro.xyz/blog/category/xenomai/" title="Auto Added by WPeMatico">Xenomai</a></li></ul></aside></div></div></div></div><footer class="page-footer text-light"><div class="container"><div class="row"><div class="col-md-12"><div class="social-icons my-5 py-7 d-flex justify-content-center"></div></div></div></div><div class="footer-copyright text-center small bg-dimped__dark py-3"> <a class="text-light" href="">© 2019</a> <span class="sep text-light mx-2"> | </span> <a class="text-light" href="https://dev-pro.xyz/">Dev-Pro</a></div></footer></div> <noscript><style>.lazyload{display:none;}</style></noscript><script data-noptimize="1">window.lazySizesConfig=window.lazySizesConfig||{};window.lazySizesConfig.loadMode=1;</script><script async data-noptimize="1" src="https://dev-pro.xyz/blog/wp-content/plugins/autoptimize/classes/external/js/lazysizes.min.js"></script><script defer src="https://dev-pro.xyz/blog/wp-content/cache/autoptimize/js/autoptimize_430637a5ce5bae584155bf0968bdd4d3.js"></script></body></html>
